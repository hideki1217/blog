---
layout: post
title:  "統計力学のテクニック： スピングラスとレプリカ法"
date:   2023-02-13 21:02:54 +0900
categories: statistical-mechanics
tags: [replica-trick, spin-glass]
---

## 記事の内容

この記事は

- スピングラスの模型
- スピングラスの解析に代表されるレプリカ法を解説

し、読者は

- レプリカ法の気持ちと、不思議な点  

を理解できます。

## スピングラス

強磁性体である鉄は、構成粒子のスピンが揃っているときにエネルギーが低くなるモデルで記述され、自発的にスピンが揃い磁化が発生する。

一方、反磁性体である金は、構成粒子のスピンが揃っていないときにエネルギーが低くなるモデルで記述され、自発的にスピンが交互になり磁化は発生しない。

この二つの金属を高音に熱し、混合し、急速に冷却すると、磁化は発生しないが、スピンの様子は自発的にランダムな様子になる**スピングラス**相と呼ばれる状態になる。

このスピングラス相は結合のエネルギーがランダムな以下のようなモデル化がなされている。

$$
H(s| \{J_{<ij>}\}) = - \sum_{<ij>} J_{<ij>} s_i s_j, ~~ J_{<ij>} \sim P(x)
$$

ここで、粒子のスピンの状態は　$$h_i \in \{1, -1\}$$ のような二値をとり、和は隣接する粒子間 $$\langle ij \rangle$$ で取るとします。
このモデルには、与えられたハミルトニアンから定まるボルツマン分布 $$P(s) \propto \exp(-\beta H(s| \{J_{<ij>}\}))$$ を用いた熱力学的平均 $$\langle A \rangle = \sum_{s} A(s) P(s)$$ に加えて、ハミルトニアンが事前分布からサンプルされることから、配位平均 $$[A(J)] = \int \prod_{<ij>} dJ_{<ij>} ~ A(J)$$ なる平均もあり、ベイズとの関わりもあるようです。

このままではハミルトニアンに添え字の対称性がないため、以下のようにモデルから隣接関係をなくしたものを解析します。

$$
H(s| \{J_{ij}\}) = - \sum_{i > j}(\frac{J_0}{N} + \frac{J_{ij}}{\sqrt{N}} ) s_i s_j, ~~ J_{ij} \sim N(x| 0, J^2) 
$$

ここで、 $$[\langle s_i \rangle]$$ を計算してみると　

$$
[\langle s_i \rangle] = \int \prod_{i>j} dJ_{ij} ~ \sum_{s} s_i \frac{\exp(-\beta H(s | \{J_{ij}\}))}{Z(\beta | \{J_{ij}\})} 
$$

となって、分母にも、分子にも $$J_{ij}$$ が含まれていて、積分が難しそうです。
ここで、出てくるのが**レプリカ法**です。

## レプリカ法

レプリカ法のアイデアは $\ln Z = \lim_{n \to 0} \frac{Z^n - 1}{n} $ なる数学の恒等式から、 $$[\langle s_i \rangle]$$ の代わりに、

$$
[\langle s_i \rangle]_n := \frac{[\langle s_i \rangle Z(\beta | \{J_{ij}\})^n]}{[Z(\beta | \{J_{ij}\})^n]} = \frac{\partial}{\partial n} \frac{\ln [e ^ {n \langle s_i \rangle}]}{n} 
$$

を計算し、 $$ n \to 0$$ として $$[\langle s_i \rangle]_n \to [\langle s_i \rangle]$$ を求めるという方法です。 $$n$$ が自然数の時、 $$[Z(\beta | \{J_{ij}\})^n]$$  は結合 $$J_{ij}$$ を共有する $$n$$ 個の合成系の分配関数にあたり、上で定義した $$[[\langle s_i \rangle]_n]$$ は、合成系の内ひとつの系の $$s_i^1$$ を観察していることに対応します。

この時、
$$
[\langle s_i \rangle Z(\beta | \{J_{ij}\})^n] = [Z(\beta | \{J_{ij}\})^{n-1} ~ \sum_{s^1} s_i^1 \exp(-\beta H(s^1 | \{J_{ij}\}))]
$$
のように、 配位平均が取りやすい形になっていることがわかります。これを用いて計算を進め、最後に $$n \to 0$$ にすることで計算するのがレプリカ法です。

このとき、計算の途中では  $$n$$ は自然数だと思って計算するため、 $$n$$ を実数だと思って $$n \to 0$$　する時の、 $$n$$ に対する連続性が表式から推察できる形になっていないことがあります。そのような場合に対しては、**レプリカ対称性**などの追加の要請によって、その連続性を表明するという方法を取ります。

レプリカ法の面白いところは、イメージとしては系の共通のパラメータをもつ**レプリカ**を作って並べた合成系を考えるというところです。この作り方では、系の入れ替えに対して対称性を持つので、系間を結ぶ巨視的変数で合成系のハミルトニアンを記述することができ、計算がしやすいです。それに対して、目的の量に近づくには、レプリカを考えたという前提を忘れて、 $$n$$ を実数だと思い、極限を取るのです。 $$n=1$$ の時は、分母と分子を別々に平均を取ったものになっており、 $$n \to 0$$ にして初めて、目的の量を求めることができます。

現状この操作に対して、数学的な正当性は認められていないようですが、結果がうまくいっていない例もまだ見つかっていないということらしいです。面白いですね！

## まとめ

スピングラスの模型を紹介し、そのモデルの分配関数をレプリカ法を用いて計算する途中までを追いながら、レプリカ法を紹介しました。

今後の記事としては、

- レプリカ対称性等の極限操作での連続性を表明する方法の紹介
- レプリカ法の数学的基礎付けの検討
- スピングラスモデルとベイズの類似性を用いた応用の調査

などが挙げられます。


## 追伸

昨日はお休みしてしまいました。サークルの友人たちとお酒を飲んでいたのですが、やはり女性のこころはわからないですねぇ。

